import matplotlib.pyplot as plt
import numpy as np
from mpl_toolkits.mplot3d.art3d import Poly3DCollection
from mpl_toolkits.mplot3d import Axes3D
def line_intersection( p1, p2, mask, epsilon=1e-10):
    """ Return the intersection point of two line segments (p1,p2) and (p3,p4) using floats with precision control """
    s1_x = p2[0] - p1[0]
    s1_y = p2[1] - p1[1]
    n = len(mask)
    
    for i in range(n):
        p3 = mask[i]
        p4 = mask[(i + 1) % n]
        s2_x = p4[0] - p3[0]
        s2_y = p4[1] - p3[1]

        denominator = -s2_x * s1_y + s1_x * s2_y
        if abs(denominator) < epsilon:
            continue  # Skip nearly parallel or coincident lines

        s = (-s1_y * (p1[0] - p3[0]) + s1_x * (p1[1] - p3[1])) / denominator
        t = (s2_x * (p1[1] - p3[1]) - s2_y * (p1[0] - p3[0])) / denominator

        if -epsilon <= s <= 1 + epsilon and -epsilon <= t <= 1 + epsilon:
            # Calculate intersection point
            intersection_x = p1[0] + (t * s1_x)
            intersection_y = p1[1] + (t * s1_y)
            return (round(intersection_x, 10), round(intersection_y, 10))  # Control float precision
    return None

def clip_paths(mask, lines):
    npath = []
    # Check all segments of path1 against all segments of path2
    lj = 0
    n = len(lines)
    for lj in range(0, n):
        if not is_in_poly(lines[lj], mask):
            if is_in_poly(lines[(lj + 1)%n], mask):
                # chen giao diem
                npath.append(line_intersection(lines[lj], lines[lj+1], mask))

        else: # diem dang xet dang o trong
            npath.append(lines[lj])
            if not is_in_poly(lines[lj + 1], mask):
                npath.append(line_intersection(lines[lj], lines[lj+1], mask))
    return npath        

           

def is_in_poly(point, polygon):
    """Determines if a point is inside a polygon using the ray-casting algorithm.
    
    Args:
        point (tuple): The point as (x, y) coordinates.
        polygon (list): A list of vertices of the polygon [(x1, y1), (x2, y2), ...].
    
    Returns:
        bool: True if the point is inside the polygon, False otherwise.
    """
    x, y = point
    n = len(polygon)
    inside = False

    # Loop through each edge of the polygon
    for i in range(n):
        x1, y1 = polygon[i]
        x2, y2 = polygon[(i + 1) % n]  # Next vertex (wraps around to the first vertex)
        
        # Check if the ray crosses the edge
        if min(y1, y2) < y <= max(y1, y2) and x <= max(x1, x2):
            # Compute the intersection point of the edge with the horizontal ray at y
            if y1 != y2:
                x_intersect = (y - y1) * (x2 - x1) / (y2 - y1) + x1
            if x1 == x2 or x <= x_intersect:
                inside = not inside

    return inside
def add_z_coordinate(points, z_value):
    """Add a fixed z-coordinate to a list of 2D points."""
    return np.array([[p[0], p[1], z_value] for p in points])


def plot_segments(ax, points, color, marker=''):
    """Plot consecutive segments in 3D given a list of points and a color."""
    for i in range(len(points) - 1):
        ax.plot([points[i][0], points[i+1][0]], 
                [points[i][1], points[i+1][1]], 
                [points[i][2], points[i+1][2]],
                color=color, marker=marker)
        
def plot_segments2(ax, points, color, marker=''):

    """Plot consecutive segments in 3D given a list of points and a color."""
    for i in range(len(points) - 1):
        ax.plot([points[i][0], points[i+1][0]], 
                [points[i][1], points[i+1][1]], 
                [points[i][2], points[i+1][2]],
                color=color, marker=marker)

# Example paths
mask = [[-4.646, 3.357], [-4.666, 2.976], [-4.672, 2.484], [-4.644, 1.7], [-4.633, 1.564], [-4.565, 1.055], [-4.504, 0.588], [-4.485, 0.477], [-4.258, -0.449], [-4.218, -0.587], [-3.987, -1.184], [-3.871, -1.483], [-3.836, -1.552], [-3.462, -2.202], [-3.067, -2.717], [-3.009, -2.786], [-2.967, -2.823], [-2.522, -3.214], [-2.243, -3.38], [-2.013, -3.52], [-1.605, -3.664], [-1.49, -3.705], [-1.038, -3.757], [-0.962, -3.766], [-0.531, -3.716], [-0.439, -3.705], [-0.077, -3.575], [0.07, -3.52], [0.332, -3.358], [0.559, -3.214], [0.702, -3.084], [1.019, -2.786], [1.037, -2.765], [1.073, -2.717], [1.318, -2.373], [1.437, -2.202], [1.569, -1.952], [1.775, -1.552], [1.793, -1.511], [1.806, -1.483], [1.966, -1.014], [2.108, -0.587], [2.125, -0.521], [2.142, -0.449], [2.237, 0.013], [2.329, 0.477], [2.337, 0.536], [2.344, 0.588], [2.391, 1.089], [2.435, 1.564], [2.438, 1.622], [2.442, 1.7], [2.444, 2.164], [2.444, 2.484], [2.436, 2.688], [2.423, 2.976], [2.405, 3.199], [2.392, 3.357], [2.347, 3.695], [2.284, 4.156], [2.278, 4.189], [2.274, 4.214], [2.169, 4.655], [2.076, 5.04], [2.01, 5.251], [1.808, 5.803], [1.553, 6.345], [1.481, 6.481], [1.393, 6.612], [1.103, 7.041], [0.712, 7.486], [0.69, 7.508], [0.679, 7.517], [0.248, 7.848], [0.075, 7.939], [-0.211, 8.091], [-0.481, 8.174], [-0.683, 8.238], [-0.995, 8.27], [-1.161, 8.287], [-1.469, 8.255], [-1.64, 8.238], [-1.906, 8.156], [-2.112, 8.091], [-2.309, 7.988], [-2.572, 7.848], [-2.68, 7.766], [-3.014, 7.508], [-3.036, 7.486], [-3.317, 7.167], [-3.425, 7.041], [-3.584, 6.806], [-3.799, 6.481], [-3.825, 6.431], [-3.869, 6.345], [-4.026, 6.007], [-4.117, 5.803], [-4.199, 5.573], [-4.309, 5.251], [-4.346, 5.128], [-4.372, 5.04], [-4.515, 4.377], [-4.55, 4.214], [-4.559, 4.156], [-4.646, 3.357]]
lines = [(4.78723, 12.23405), (5.31915, 11.3872), (5.85106, 11.17022), (6.38298, 10.32337), (6.38298, 9.25954), (5.85106, 10.10639), (5.31915, 10.32337), (4.78723, 11.17022), (4.25532, 11.3872), (3.7234, 12.23405), (2.65957, 12.23405), (3.19149, 11.3872), (3.7234, 11.17022), (4.25532, 10.32337), (4.78723, 10.10639), (5.31915, 9.25954), (5.85106, 9.04255), (6.38298, 8.1957), (6.38298, 7.13187), (5.85106, 7.97872), (5.31915, 8.1957), (4.78723, 9.04255), (4.25532, 9.25954), (3.7234, 10.10639), (3.19149, 10.32337), (2.65957, 11.17022), (2.12766, 11.3872), (1.59574, 12.23405), (0.53191, 12.23405), (1.06383, 11.3872), (1.59574, 11.17022), (2.12766, 10.32337), (2.65957, 10.10639), (3.19149, 9.25954), (3.7234, 9.04255), (4.25532, 8.1957), (4.78723, 7.97872), (5.31915, 7.13187), (5.85106, 6.91489), (6.38298, 6.06804), (6.38298, 5.00422), (5.85106, 5.85107), (5.31915, 6.06804), (4.78723, 6.91489), (4.25532, 7.13187), (3.7234, 7.97872), (3.19149, 8.1957), (2.65957, 9.04255), (2.12766, 9.25954), (1.59574, 10.10639), (1.06383, 10.32337), (0.53191, 11.17022), (0.0, 11.3872), (-0.53192, 12.23405), (-1.59575, 12.23405), (-1.06383, 11.3872), (-0.53192, 11.17022), (0.0, 10.32337), (0.53191, 10.10639), (1.06383, 9.25954), (1.59574, 9.04255), (2.12766, 8.1957), (2.65957, 7.97872), (3.19149, 7.13187), (3.7234, 6.91489), (4.25532, 6.06804), (4.78723, 5.85107), (5.31915, 5.00422), (5.85106, 4.78724), (6.38298, 3.94039), (6.38298, 2.87655), (5.85106, 3.7234), (5.31915, 3.94039), (4.78723, 4.78724), (4.25532, 5.00422), (3.7234, 5.85107), (3.19149, 6.06804), (2.65957, 6.91489), (2.12766, 7.13187), (1.59574, 7.97872), (1.06383, 8.1957), (0.53191, 9.04255), (0.0, 9.25954), (-0.53192, 10.10639), (-1.06383, 10.32337), (-1.59575, 11.17022), (-2.12766, 11.3872), (-2.65958, 12.23405), (-3.72341, 12.23405), (-3.19149, 11.3872), (-2.65958, 11.17022), (-2.12766, 10.32337), (-1.59575, 10.10639), (-1.06383, 9.25954), (-0.53192, 9.04255), (0.0, 8.1957), (0.53191, 7.97872), (1.06383, 7.13187), (1.59574, 6.91489), (2.12766, 6.06804), (2.65957, 5.85107), (3.19149, 5.00422), (3.7234, 4.78724), (4.25532, 3.94039), (4.78723, 3.7234), (5.31915, 2.87655), (5.85106, 2.65958), (6.38298, 1.81273), (6.38298, 0.74889), (5.85106, 1.59574), (5.31915, 1.81273), (4.78723, 2.65958), (4.25532, 2.87655), (3.7234, 3.7234), (3.19149, 3.94039), (2.65957, 4.78724), (2.12766, 5.00422), (1.59574, 5.85107), (1.06383, 6.06804), (0.53191, 6.91489), (0.0, 7.13187), (-0.53192, 7.97872), (-1.06383, 8.1957), (-1.59575, 9.04255), (-2.12766, 9.25954), (-2.65958, 10.10639), (-3.19149, 10.32337), (-3.72341, 11.17022), (-4.25532, 11.3872), (-4.78724, 12.23405), (-5.85107, 12.23405), (-5.31915, 11.3872), (-4.78724, 11.17022), (-4.25532, 10.32337), (-3.72341, 10.10639), (-3.19149, 9.25954), (-2.65958, 9.04255), (-2.12766, 8.1957), (-1.59575, 7.97872), (-1.06383, 7.13187), (-0.53192, 6.91489), (0.0, 6.06804), (0.53191, 5.85107), (1.06383, 5.00422), (1.59574, 4.78724), (2.12766, 3.94039), (2.65957, 3.7234), (3.19149, 2.87655), (3.7234, 2.65958), (4.25532, 1.81273), (4.78723, 1.59574), (5.31915, 0.74889), (5.85106, 0.53191), (6.38298, -0.31494), (6.38298, -1.37876), (5.85106, -0.53191), (5.31915, -0.31494), (4.78723, 0.53191), (4.25532, 0.74889), (3.7234, 1.59574), (3.19149, 1.81273), (2.65957, 2.65958), (2.12766, 2.87655), (1.59574, 3.7234), (1.06383, 3.94039), (0.53191, 4.78724), (0.0, 5.00422), (-0.53192, 5.85107), (-1.06383, 6.06804), (-1.59575, 6.91489), (-2.12766, 7.13187), (-2.65958, 7.97872), (-3.19149, 8.1957), (-3.72341, 9.04255), (-4.25532, 9.25954), (-4.78724, 10.10639), (-5.31915, 10.32337), (-5.85107, 11.17022), (-6.38298, 11.3872), (-6.38298, 10.32337), (-5.85107, 10.10639), (-5.31915, 9.25954), (-4.78724, 9.04255), (-4.25532, 8.1957), (-3.72341, 7.97872), (-3.19149, 7.13187), (-2.65958, 6.91489), (-2.12766, 6.06804), (-1.59575, 5.85107), (-1.06383, 5.00422), (-0.53192, 4.78724), (0.0, 3.94039), (0.53191, 3.7234), (1.06383, 2.87655), (1.59574, 2.65958), (2.12766, 1.81273), (2.65957, 1.59574), (3.19149, 0.74889), (3.7234, 0.53191), (4.25532, -0.31494), (4.78723, -0.53191), (5.31915, -1.37876), (5.85106, -1.59575), (6.38298, -2.4426), (6.38298, -3.50643), (5.85106, -2.65958), (5.31915, -2.4426), (4.78723, -1.59575), (4.25532, -1.37876), (3.7234, -0.53191), (3.19149, -0.31494), (2.65957, 0.53191), (2.12766, 0.74889), (1.59574, 1.59574), (1.06383, 1.81273), (0.53191, 2.65958), (0.0, 2.87655), (-0.53192, 3.7234), (-1.06383, 3.94039), (-1.59575, 4.78724), (-2.12766, 5.00422), (-2.65958, 5.85107), (-3.19149, 6.06804), (-3.72341, 6.91489), (-4.25532, 7.13187), (-4.78724, 7.97872), (-5.31915, 8.1957), (-5.85107, 9.04255), (-6.38298, 9.25954), (-6.38298, 8.1957), (-5.85107, 7.97872), (-5.31915, 7.13187), (-4.78724, 6.91489), (-4.25532, 6.06804), (-3.72341, 5.85107), (-3.19149, 5.00422), (-2.65958, 4.78724), (-2.12766, 3.94039), (-1.59575, 3.7234), (-1.06383, 2.87655), (-0.53192, 2.65958), (0.0, 1.81273), (0.53191, 1.59574), (1.06383, 0.74889), (1.59574, 0.53191), (2.12766, -0.31494), (2.65957, -0.53191), (3.19149, -1.37876), (3.7234, -1.59575), (4.25532, -2.4426), (4.78723, -2.65958), (5.31915, -3.50643), (5.85106, -3.7234), (6.38298, -4.57026), (6.38298, -5.63408), (5.85106, -4.78723), (5.31915, -4.57026), (4.78723, -3.7234), (4.25532, -3.50643), (3.7234, -2.65958), (3.19149, -2.4426), (2.65957, -1.59575), (2.12766, -1.37876), (1.59574, -0.53191), (1.06383, -0.31494), (0.53191, 0.53191), (0.0, 0.74889), (-0.53192, 1.59574), (-1.06383, 1.81273), (-1.59575, 2.65958), (-2.12766, 2.87655), (-2.65958, 3.7234), (-3.19149, 3.94039), (-3.72341, 4.78724), (-4.25532, 5.00422), (-4.78724, 5.85107), (-5.31915, 6.06804), (-5.85107, 6.91489), (-6.38298, 7.13187), (-6.38298, 6.06804), (-5.85107, 5.85107), (-5.31915, 5.00422), (-4.78724, 4.78724), (-4.25532, 3.94039), (-3.72341, 3.7234), (-3.19149, 2.87655), (-2.65958, 2.65958), (-2.12766, 1.81273), (-1.59575, 1.59574), (-1.06383, 0.74889), (-0.53192, 0.53191), (0.0, -0.31494), (0.53191, -0.53191), (1.06383, -1.37876), (1.59574, -1.59575), (2.12766, -2.4426), (2.65957, -2.65958), (3.19149, -3.50643), (3.7234, -3.7234), (4.25532, -4.57026), (4.78723, -4.78723), (5.31915, -5.63408), (5.85106, -5.85107), (6.38298, -6.69792), (6.38298, -7.76175), (5.85106, -6.9149), (5.31915, -6.69792), (4.78723, -5.85107), (4.25532, -5.63408), (3.7234, -4.78723), (3.19149, -4.57026), (2.65957, -3.7234), (2.12766, -3.50643), (1.59574, -2.65958), (1.06383, -2.4426), (0.53191, -1.59575), (0.0, -1.37876), (-0.53192, -0.53191), (-1.06383, -0.31494), (-1.59575, 0.53191), (-2.12766, 0.74889), (-2.65958, 1.59574), (-3.19149, 1.81273), (-3.72341, 2.65958), (-4.25532, 2.87655), (-4.78724, 3.7234), (-5.31915, 3.94039), (-5.85107, 4.78724), (-6.38298, 5.00422), (-6.38298, 3.94039), (-5.85107, 3.7234), (-5.31915, 2.87655), (-4.78724, 2.65958), (-4.25532, 1.81273), (-3.72341, 1.59574), (-3.19149, 0.74889), (-2.65958, 0.53191), (-2.12766, -0.31494), (-1.59575, -0.53191), (-1.06383, -1.37876), (-0.53192, -1.59575), (0.0, -2.4426), (0.53191, -2.65958), (1.06383, -3.50643), (1.59574, -3.7234), (2.12766, -4.57026), (2.65957, -4.78723), (3.19149, -5.63408), (3.7234, -5.85107), (4.25532, -6.69792), (4.78723, -6.9149), (5.31915, -7.76175), (5.85106, -7.97872), (6.38298, -8.82558), (6.38298, -9.88941), (5.85106, -9.04256), (5.31915, -8.82558), (4.78723, -7.97872), (4.25532, -7.76175), (3.7234, -6.9149), (3.19149, -6.69792), (2.65957, -5.85107), (2.12766, -5.63408), (1.59574, -4.78723), (1.06383, -4.57026), (0.53191, -3.7234), (0.0, -3.50643), (-0.53192, -2.65958), (-1.06383, -2.4426), (-1.59575, -1.59575), (-2.12766, -1.37876), (-2.65958, -0.53191), (-3.19149, -0.31494), (-3.72341, 0.53191), (-4.25532, 0.74889), (-4.78724, 1.59574), (-5.31915, 1.81273), (-5.85107, 2.65958), (-6.38298, 2.87655), (-6.38298, 1.81273), (-5.85107, 1.59574), (-5.31915, 0.74889), (-4.78724, 0.53191), (-4.25532, -0.31494), (-3.72341, -0.53191), (-3.19149, -1.37876), (-2.65958, -1.59575), (-2.12766, -2.4426), (-1.59575, -2.65958), (-1.06383, -3.50643), (-0.53192, -3.7234), (0.0, -4.57026), (0.53191, -4.78723), (1.06383, -5.63408), (1.59574, -5.85107), (2.12766, -6.69792), (2.65957, -6.9149), (3.19149, -7.76175), (3.7234, -7.97872), (4.25532, -8.82558), (4.78723, -9.04256), (5.31915, -9.88941), (5.85106, -10.10638), (6.38298, -10.95323), (6.38298, -12.01707), (5.85106, -11.17022), (5.31915, -10.95323), (4.78723, -10.10638), (4.25532, -9.88941), (3.7234, -9.04256), (3.19149, -8.82558), (2.65957, -7.97872), (2.12766, -7.76175), (1.59574, -6.9149), (1.06383, -6.69792), (0.53191, -5.85107), (0.0, -5.63408), (-0.53192, -4.78723), (-1.06383, -4.57026), (-1.59575, -3.7234), (-2.12766, -3.50643), (-2.65958, -2.65958), (-3.19149, -2.4426), (-3.72341, -1.59575), (-4.25532, -1.37876), (-4.78724, -0.53191), (-5.31915, -0.31494), (-5.85107, 0.53191), (-6.38298, 0.74889), (-6.38298, -0.31494), (-5.85107, -0.53191), (-5.31915, -1.37876), (-4.78724, -1.59575), (-4.25532, -2.4426), (-3.72341, -2.65958), (-3.19149, -3.50643), (-2.65958, -3.7234), (-2.12766, -4.57026), (-1.59575, -4.78723), (-1.06383, -5.63408), (-0.53192, -5.85107), (0.0, -6.69792), (0.53191, -6.9149), (1.06383, -7.76175), (1.59574, -7.97872), (2.12766, -8.82558), (2.65957, -9.04256), (3.19149, -9.88941), (3.7234, -10.10638), (4.25532, -10.95323), (4.78723, -11.17022), (5.31915, -12.01707), (5.85106, -12.23405), (4.78723, -12.23405), (4.25532, -12.01707), (3.7234, -11.17022), (3.19149, -10.95323), (2.65957, -10.10638), (2.12766, -9.88941), (1.59574, -9.04256), (1.06383, -8.82558), (0.53191, -7.97872), (0.0, -7.76175), (-0.53192, -6.9149), (-1.06383, -6.69792), (-1.59575, -5.85107), (-2.12766, -5.63408), (-2.65958, -4.78723), (-3.19149, -4.57026), (-3.72341, -3.7234), (-4.25532, -3.50643), (-4.78724, -2.65958), (-5.31915, -2.4426), (-5.85107, -1.59575), (-6.38298, -1.37876), (-6.38298, -2.4426), (-5.85107, -2.65958), (-5.31915, -3.50643), (-4.78724, -3.7234), (-4.25532, -4.57026), (-3.72341, -4.78723), (-3.19149, -5.63408), (-2.65958, -5.85107), (-2.12766, -6.69792), (-1.59575, -6.9149), (-1.06383, -7.76175), (-0.53192, -7.97872), (0.0, -8.82558), (0.53191, -9.04256), (1.06383, -9.88941), (1.59574, -10.10638), (2.12766, -10.95323), (2.65957, -11.17022), (3.19149, -12.01707), (3.7234, -12.23405), (2.65957, -12.23405), (2.12766, -12.01707), (1.59574, -11.17022), (1.06383, -10.95323), (0.53191, -10.10638), (0.0, -9.88941), (-0.53192, -9.04256), (-1.06383, -8.82558), (-1.59575, -7.97872), (-2.12766, -7.76175), (-2.65958, -6.9149), (-3.19149, -6.69792), (-3.72341, -5.85107), (-4.25532, -5.63408), (-4.78724, -4.78723), (-5.31915, -4.57026), (-5.85107, -3.7234), (-6.38298, -3.50643), (-6.38298, -4.57026), (-5.85107, -4.78723), (-5.31915, -5.63408), (-4.78724, -5.85107), (-4.25532, -6.69792), (-3.72341, -6.9149), (-3.19149, -7.76175), (-2.65958, -7.97872), (-2.12766, -8.82558), (-1.59575, -9.04256), (-1.06383, -9.88941), (-0.53192, -10.10638), (0.0, -10.95323), (0.53191, -11.17022), (1.06383, -12.01707), (1.59574, -12.23405), (0.53191, -12.23405), (0.0, -12.01707), (-0.53192, -11.17022), (-1.06383, -10.95323), (-1.59575, -10.10638), (-2.12766, -9.88941), (-2.65958, -9.04256), (-3.19149, -8.82558), (-3.72341, -7.97872), (-4.25532, -7.76175), (-4.78724, -6.9149), (-5.31915, -6.69792), (-5.85107, -5.85107), (-6.38298, -5.63408), (-6.38298, -6.69792), (-5.85107, -6.9149), (-5.31915, -7.76175), (-4.78724, -7.97872), (-4.25532, -8.82558), (-3.72341, -9.04256), (-3.19149, -9.88941), (-2.65958, -10.10638), (-2.12766, -10.95323), (-1.59575, -11.17022), (-1.06383, -12.01707), (-0.53192, -12.23405), (-1.59575, -12.23405), (-2.12766, -12.01707), (-2.65958, -11.17022), (-3.19149, -10.95323), (-3.72341, -10.10638), (-4.25532, -9.88941), (-4.78724, -9.04256), (-5.31915, -8.82558), (-5.85107, -7.97872), (-6.38298, -7.76175), (-6.38298, -8.82558), (-5.85107, -9.04256), (-5.31915, -9.88941), (-4.78724, -10.10638), (-4.25532, -10.95323), (-3.72341, -11.17022), (-3.19149, -12.01707), (-2.65958, -12.23405), (-3.72341, -12.23405), (-4.25532, -12.01707), (-4.78724, -11.17022), (-5.31915, -10.95323), (-5.85107, -10.10638), (-6.38298, -9.88941), (-6.38298, -10.95323), (-5.85107, -11.17022), (-5.31915, -12.01707), (-4.78724, -12.23405)]

mask2 = [[-4.675, 0.856], [-4.525, 0.0], [-4.476, -0.198], [-4.235, -1.022], [-4.124, -1.31], [-3.873, -1.878], [-3.521, -2.483], [-3.455, -2.586], [-3.384, -2.669], [-2.992, -3.135], [-2.587, -3.484], [-2.498, -3.563], [-2.252, -3.709], [-1.982, -3.859], [-1.909, -3.883], [-1.453, -4.032], [-1.309, -4.048], [-0.921, -4.09], [-0.766, -4.073], [-0.392, -4.032], [-0.273, -3.993], [0.124, -3.859], [0.173, -3.831], [0.384, -3.709], [0.574, -3.592], [0.62, -3.563], [0.928, -3.282], [1.085, -3.135], [1.246, -2.931], [1.514, -2.586], [1.535, -2.549], [1.574, -2.483], [1.774, -2.105], [1.891, -1.878], [1.985, -1.64], [2.112, -1.31], [2.167, -1.15], [2.209, -1.022], [2.308, -0.626], [2.412, -0.198], [2.452, 0.0], [2.514, 0.455], [2.567, 0.856], [2.582, 1.005], [2.598, 1.185], [2.616, 1.564], [2.628, 1.855], [2.63, 2.117], [2.63, 2.466], [2.623, 2.66], [2.618, 2.8], [2.586, 3.194], [2.543, 3.712], [2.542, 3.719], [2.54, 3.729], [2.456, 4.224], [2.391, 4.592], [2.36, 4.724], [2.315, 4.908], [2.232, 5.207], [2.172, 5.421], [1.94, 6.054], [1.888, 6.181], [1.804, 6.339], [1.544, 6.83], [1.285, 7.212], [1.159, 7.382], [1.067, 7.475], [0.737, 7.816], [0.432, 8.049], [0.292, 8.156], [-0.151, 8.39], [-0.17, 8.4], [-0.301, 8.44], [-0.645, 8.538], [-0.683, 8.542], [-1.126, 8.584], [-1.179, 8.579], [-1.608, 8.538], [-1.641, 8.529], [-1.952, 8.44], [-2.071, 8.404], [-2.084, 8.4], [-2.463, 8.201], [-2.548, 8.156], [-2.823, 7.947], [-2.994, 7.816], [-3.154, 7.654], [-3.415, 7.382], [-3.455, 7.329], [-3.541, 7.212], [-3.717, 6.952], [-3.798, 6.83], [-3.948, 6.546], [-4.135, 6.181], [-4.155, 6.131], [-4.185, 6.054], [-4.321, 5.671], [-4.407, 5.421], [-4.541, 4.908], [-4.61, 4.592], [-4.738, 3.729], [-4.74, 3.712], [-4.742, 3.666], [-4.79, 2.8], [-4.792, 2.466], [-4.771, 1.855], [-4.718, 1.185], [-4.675, 0.856]]

lines2 =[(4.78723, -12.23405), (5.31915, -12.01707), (5.85106, -11.17022), (6.38298, -10.95323), (6.38298, -9.88941), (5.85106, -10.10638), (5.31915, -10.95323), (4.78723, -11.17022), (4.25532, -12.01707), (3.7234, -12.23405), (2.65957, -12.23405), (3.19149, -12.01707), (3.7234, -11.17022), (4.25532, -10.95323), (4.78723, -10.10638), (5.31915, -9.88941), (5.85106, -9.04256), (6.38298, -8.82558), (6.38298, -7.76175), (5.85106, -7.97872), (5.31915, -8.82558), (4.78723, -9.04256), (4.25532, -9.88941), (3.7234, -10.10638), (3.19149, -10.95323), (2.65957, -11.17022), (2.12766, -12.01707), (1.59574, -12.23405), (0.53191, -12.23405), (1.06383, -12.01707), (1.59574, -11.17022), (2.12766, -10.95323), (2.65957, -10.10638), (3.19149, -9.88941), (3.7234, -9.04256), (4.25532, -8.82558), (4.78723, -7.97872), (5.31915, -7.76175), (5.85106, -6.9149), (6.38298, -6.69792), (6.38298, -5.63408), (5.85106, -5.85107), (5.31915, -6.69792), (4.78723, -6.9149), (4.25532, -7.76175), (3.7234, -7.97872), (3.19149, -8.82558), (2.65957, -9.04256), (2.12766, -9.88941), (1.59574, -10.10638), (1.06383, -10.95323), (0.53191, -11.17022), (0.0, -12.01707), (-0.53192, -12.23405), (-1.59575, -12.23405), (-1.06383, -12.01707), (-0.53192, -11.17022), (0.0, -10.95323), (0.53191, -10.10638), (1.06383, -9.88941), (1.59574, -9.04256), (2.12766, -8.82558), (2.65957, -7.97872), (3.19149, -7.76175), (3.7234, -6.9149), (4.25532, -6.69792), (4.78723, -5.85107), (5.31915, -5.63408), (5.85106, -4.78723), (6.38298, -4.57026), (6.38298, -3.50643), (5.85106, -3.7234), (5.31915, -4.57026), (4.78723, -4.78723), (4.25532, -5.63408), (3.7234, -5.85107), (3.19149, -6.69792), (2.65957, -6.9149), (2.12766, -7.76175), (1.59574, -7.97872), (1.06383, -8.82558), (0.53191, -9.04256), (0.0, -9.88941), (-0.53192, -10.10638), (-1.06383, -10.95323), (-1.59575, -11.17022), (-2.12766, -12.01707), (-2.65958, -12.23405), (-3.72341, -12.23405), (-3.19149, -12.01707), (-2.65958, -11.17022), (-2.12766, -10.95323), (-1.59575, -10.10638), (-1.06383, -9.88941), (-0.53192, -9.04256), (0.0, -8.82558), (0.53191, -7.97872), (1.06383, -7.76175), (1.59574, -6.9149), (2.12766, -6.69792), (2.65957, -5.85107), (3.19149, -5.63408), (3.7234, -4.78723), (4.25532, -4.57026), (4.78723, -3.7234), (5.31915, -3.50643), (5.85106, -2.65958), (6.38298, -2.4426), (6.38298, -1.37876), (5.85106, -1.59575), (5.31915, -2.4426), (4.78723, -2.65958), (4.25532, -3.50643), (3.7234, -3.7234), (3.19149, -4.57026), (2.65957, -4.78723), (2.12766, -5.63408), (1.59574, -5.85107), (1.06383, -6.69792), (0.53191, -6.9149), (0.0, -7.76175), (-0.53192, -7.97872), (-1.06383, -8.82558), (-1.59575, -9.04256), (-2.12766, -9.88941), (-2.65958, -10.10638), (-3.19149, -10.95323), (-3.72341, -11.17022), (-4.25532, -12.01707), (-4.78724, -12.23405), (-5.85107, -12.23405), (-5.31915, -12.01707), (-4.78724, -11.17022), (-4.25532, -10.95323), (-3.72341, -10.10638), (-3.19149, -9.88941), (-2.65958, -9.04256), (-2.12766, -8.82558), (-1.59575, -7.97872), (-1.06383, -7.76175), (-0.53192, -6.9149), (0.0, -6.69792), (0.53191, -5.85107), (1.06383, -5.63408), (1.59574, -4.78723), (2.12766, -4.57026), (2.65957, -3.7234), (3.19149, -3.50643), (3.7234, -2.65958), (4.25532, -2.4426), (4.78723, -1.59575), (5.31915, -1.37876), (5.85106, -0.53191), (6.38298, -0.31494), (6.38298, 0.74889), (5.85106, 0.53191), (5.31915, -0.31494), (4.78723, -0.53191), (4.25532, -1.37876), (3.7234, -1.59575), (3.19149, -2.4426), (2.65957, -2.65958), (2.12766, -3.50643), (1.59574, -3.7234), (1.06383, -4.57026), (0.53191, -4.78723), (0.0, -5.63408), (-0.53192, -5.85107), (-1.06383, -6.69792), (-1.59575, -6.9149), (-2.12766, -7.76175), (-2.65958, -7.97872), (-3.19149, -8.82558), (-3.72341, -9.04256), (-4.25532, -9.88941), (-4.78724, -10.10638), (-5.31915, -10.95323), (-5.85107, -11.17022), (-6.38298, -12.01707), (-6.38298, -10.95323), (-5.85107, -10.10638), (-5.31915, -9.88941), (-4.78724, -9.04256), (-4.25532, -8.82558), (-3.72341, -7.97872), (-3.19149, -7.76175), (-2.65958, -6.9149), (-2.12766, -6.69792), (-1.59575, -5.85107), (-1.06383, -5.63408), (-0.53192, -4.78723), (0.0, -4.57026), (0.53191, -3.7234), (1.06383, -3.50643), (1.59574, -2.65958), (2.12766, -2.4426), (2.65957, -1.59575), (3.19149, -1.37876), (3.7234, -0.53191), (4.25532, -0.31494), (4.78723, 0.53191), (5.31915, 0.74889), (5.85106, 1.59574), (6.38298, 1.81273), (6.38298, 2.87655), (5.85106, 2.65958), (5.31915, 1.81273), (4.78723, 1.59574), (4.25532, 0.74889), (3.7234, 0.53191), (3.19149, -0.31494), (2.65957, -0.53191), (2.12766, -1.37876), (1.59574, -1.59575), (1.06383, -2.4426), (0.53191, -2.65958), (0.0, -3.50643), (-0.53192, -3.7234), (-1.06383, -4.57026), (-1.59575, -4.78723), (-2.12766, -5.63408), (-2.65958, -5.85107), (-3.19149, -6.69792), (-3.72341, -6.9149), (-4.25532, -7.76175), (-4.78724, -7.97872), (-5.31915, -8.82558), (-5.85107, -9.04256), (-6.38298, -9.88941), (-6.38298, -8.82558), (-5.85107, -7.97872), (-5.31915, -7.76175), (-4.78724, -6.9149), (-4.25532, -6.69792), (-3.72341, -5.85107), (-3.19149, -5.63408), (-2.65958, -4.78723), (-2.12766, -4.57026), (-1.59575, -3.7234), (-1.06383, -3.50643), (-0.53192, -2.65958), (0.0, -2.4426), (0.53191, -1.59575), (1.06383, -1.37876), (1.59574, -0.53191), (2.12766, -0.31494), (2.65957, 0.53191), (3.19149, 0.74889), (3.7234, 1.59574), (4.25532, 1.81273), (4.78723, 2.65958), (5.31915, 2.87655), (5.85106, 3.7234), (6.38298, 3.94039), (6.38298, 5.00422), (5.85106, 4.78724), (5.31915, 3.94039), (4.78723, 3.7234), (4.25532, 2.87655), (3.7234, 2.65958), (3.19149, 1.81273), (2.65957, 1.59574), (2.12766, 0.74889), (1.59574, 0.53191), (1.06383, -0.31494), (0.53191, -0.53191), (0.0, -1.37876), (-0.53192, -1.59575), (-1.06383, -2.4426), (-1.59575, -2.65958), (-2.12766, -3.50643), (-2.65958, -3.7234), (-3.19149, -4.57026), (-3.72341, -4.78723), (-4.25532, -5.63408), (-4.78724, -5.85107), (-5.31915, -6.69792), (-5.85107, -6.9149), (-6.38298, -7.76175), (-6.38298, -6.69792), (-5.85107, -5.85107), (-5.31915, -5.63408), (-4.78724, -4.78723), (-4.25532, -4.57026), (-3.72341, -3.7234), (-3.19149, -3.50643), (-2.65958, -2.65958), (-2.12766, -2.4426), (-1.59575, -1.59575), (-1.06383, -1.37876), (-0.53192, -0.53191), (0.0, -0.31494), (0.53191, 0.53191), (1.06383, 0.74889), (1.59574, 1.59574), (2.12766, 1.81273), (2.65957, 2.65958), (3.19149, 2.87655), (3.7234, 3.7234), (4.25532, 3.94039), (4.78723, 4.78724), (5.31915, 5.00422), (5.85106, 5.85107), (6.38298, 6.06804), (6.38298, 7.13187), (5.85106, 6.91489), (5.31915, 6.06804), (4.78723, 5.85107), (4.25532, 5.00422), (3.7234, 4.78724), (3.19149, 3.94039), (2.65957, 3.7234), (2.12766, 2.87655), (1.59574, 2.65958), (1.06383, 1.81273), (0.53191, 1.59574), (0.0, 0.74889), (-0.53192, 0.53191), (-1.06383, -0.31494), (-1.59575, -0.53191), (-2.12766, -1.37876), (-2.65958, -1.59575), (-3.19149, -2.4426), (-3.72341, -2.65958), (-4.25532, -3.50643), (-4.78724, -3.7234), (-5.31915, -4.57026), (-5.85107, -4.78723), (-6.38298, -5.63408), (-6.38298, -4.57026), (-5.85107, -3.7234), (-5.31915, -3.50643), (-4.78724, -2.65958), (-4.25532, -2.4426), (-3.72341, -1.59575), (-3.19149, -1.37876), (-2.65958, -0.53191), (-2.12766, -0.31494), (-1.59575, 0.53191), (-1.06383, 0.74889), (-0.53192, 1.59574), (0.0, 1.81273), (0.53191, 2.65958), (1.06383, 2.87655), (1.59574, 3.7234), (2.12766, 3.94039), (2.65957, 4.78724), (3.19149, 5.00422), (3.7234, 5.85107), (4.25532, 6.06804), (4.78723, 6.91489), (5.31915, 7.13187), (5.85106, 7.97872), (6.38298, 8.1957), (6.38298, 9.25954), (5.85106, 9.04255), (5.31915, 8.1957), (4.78723, 7.97872), (4.25532, 7.13187), (3.7234, 6.91489), (3.19149, 6.06804), (2.65957, 5.85107), (2.12766, 5.00422), (1.59574, 4.78724), (1.06383, 3.94039), (0.53191, 3.7234), (0.0, 2.87655), (-0.53192, 2.65958), (-1.06383, 1.81273), (-1.59575, 1.59574), (-2.12766, 0.74889), (-2.65958, 0.53191), (-3.19149, -0.31494), (-3.72341, -0.53191), (-4.25532, -1.37876), (-4.78724, -1.59575), (-5.31915, -2.4426), (-5.85107, -2.65958), (-6.38298, -3.50643), (-6.38298, -2.4426), (-5.85107, -1.59575), (-5.31915, -1.37876), (-4.78724, -0.53191), (-4.25532, -0.31494), (-3.72341, 0.53191), (-3.19149, 0.74889), (-2.65958, 1.59574), (-2.12766, 1.81273), (-1.59575, 2.65958), (-1.06383, 2.87655), (-0.53192, 3.7234), (0.0, 3.94039), (0.53191, 4.78724), (1.06383, 5.00422), (1.59574, 5.85107), (2.12766, 6.06804), (2.65957, 6.91489), (3.19149, 7.13187), (3.7234, 7.97872), (4.25532, 8.1957), (4.78723, 9.04255), (5.31915, 9.25954), (5.85106, 10.10639), (6.38298, 10.32337), (6.38298, 11.3872), (5.85106, 11.17022), (5.31915, 10.32337), (4.78723, 10.10639), (4.25532, 9.25954), (3.7234, 9.04255), (3.19149, 8.1957), (2.65957, 7.97872), (2.12766, 7.13187), (1.59574, 6.91489), (1.06383, 6.06804), (0.53191, 5.85107), (0.0, 5.00422), (-0.53192, 4.78724), (-1.06383, 3.94039), (-1.59575, 3.7234), (-2.12766, 2.87655), (-2.65958, 2.65958), (-3.19149, 1.81273), (-3.72341, 1.59574), (-4.25532, 0.74889), (-4.78724, 0.53191), (-5.31915, -0.31494), (-5.85107, -0.53191), (-6.38298, -1.37876), (-6.38298, -0.31494), (-5.85107, 0.53191), (-5.31915, 0.74889), (-4.78724, 1.59574), (-4.25532, 1.81273), (-3.72341, 2.65958), (-3.19149, 2.87655), (-2.65958, 3.7234), (-2.12766, 3.94039), (-1.59575, 4.78724), (-1.06383, 5.00422), (-0.53192, 5.85107), (0.0, 6.06804), (0.53191, 6.91489), (1.06383, 7.13187), (1.59574, 7.97872), (2.12766, 8.1957), (2.65957, 9.04255), (3.19149, 9.25954), (3.7234, 10.10639), (4.25532, 10.32337), (4.78723, 11.17022), (5.31915, 11.3872), (5.85106, 12.23405), (4.78723, 12.23405), (4.25532, 11.3872), (3.7234, 11.17022), (3.19149, 10.32337), (2.65957, 10.10639), (2.12766, 9.25954), (1.59574, 9.04255), (1.06383, 8.1957), (0.53191, 7.97872), (0.0, 7.13187), (-0.53192, 6.91489), (-1.06383, 6.06804), (-1.59575, 5.85107), (-2.12766, 5.00422), (-2.65958, 4.78724), (-3.19149, 3.94039), (-3.72341, 3.7234), (-4.25532, 2.87655), (-4.78724, 2.65958), (-5.31915, 1.81273), (-5.85107, 1.59574), (-6.38298, 0.74889), (-6.38298, 1.81273), (-5.85107, 2.65958), (-5.31915, 2.87655), (-4.78724, 3.7234), (-4.25532, 3.94039), (-3.72341, 4.78724), (-3.19149, 5.00422), (-2.65958, 5.85107), (-2.12766, 6.06804), (-1.59575, 6.91489), (-1.06383, 7.13187), (-0.53192, 7.97872), (0.0, 8.1957), (0.53191, 9.04255), (1.06383, 9.25954), (1.59574, 10.10639), (2.12766, 10.32337), (2.65957, 11.17022), (3.19149, 11.3872), (3.7234, 12.23405), (2.65957, 12.23405), (2.12766, 11.3872), (1.59574, 11.17022), (1.06383, 10.32337), (0.53191, 10.10639), (0.0, 9.25954), (-0.53192, 9.04255), (-1.06383, 8.1957), (-1.59575, 7.97872), (-2.12766, 7.13187), (-2.65958, 6.91489), (-3.19149, 6.06804), (-3.72341, 5.85107), (-4.25532, 5.00422), (-4.78724, 4.78724), (-5.31915, 3.94039), (-5.85107, 3.7234), (-6.38298, 2.87655), (-6.38298, 3.94039), (-5.85107, 4.78724), (-5.31915, 5.00422), (-4.78724, 5.85107), (-4.25532, 6.06804), (-3.72341, 6.91489), (-3.19149, 7.13187), (-2.65958, 7.97872), (-2.12766, 8.1957), (-1.59575, 9.04255), (-1.06383, 9.25954), (-0.53192, 10.10639), (0.0, 10.32337), (0.53191, 11.17022), (1.06383, 11.3872), (1.59574, 12.23405), (0.53191, 12.23405), (0.0, 11.3872), (-0.53192, 11.17022), (-1.06383, 10.32337), (-1.59575, 10.10639), (-2.12766, 9.25954), (-2.65958, 9.04255), (-3.19149, 8.1957), (-3.72341, 7.97872), (-4.25532, 7.13187), (-4.78724, 6.91489), (-5.31915, 6.06804), (-5.85107, 5.85107), (-6.38298, 5.00422), (-6.38298, 6.06804), (-5.85107, 6.91489), (-5.31915, 7.13187), (-4.78724, 7.97872), (-4.25532, 8.1957), (-3.72341, 9.04255), (-3.19149, 9.25954), (-2.65958, 10.10639), (-2.12766, 10.32337), (-1.59575, 11.17022), (-1.06383, 11.3872), (-0.53192, 12.23405), (-1.59575, 12.23405), (-2.12766, 11.3872), (-2.65958, 11.17022), (-3.19149, 10.32337), (-3.72341, 10.10639), (-4.25532, 9.25954), (-4.78724, 9.04255), (-5.31915, 8.1957), (-5.85107, 7.97872), (-6.38298, 7.13187), (-6.38298, 8.1957), (-5.85107, 9.04255), (-5.31915, 9.25954), (-4.78724, 10.10639), (-4.25532, 10.32337), (-3.72341, 11.17022), (-3.19149, 11.3872), (-2.65958, 12.23405), (-3.72341, 12.23405), (-4.25532, 11.3872), (-4.78724, 11.17022), (-5.31915, 10.32337), (-5.85107, 10.10639), (-6.38298, 9.25954), (-6.38298, 10.32337), (-5.85107, 11.17022), (-5.31915, 11.3872), (-4.78724, 12.23405)]

mask3 = [[2.303, -1.429], [2.351, -1.263], [2.409, -1.061], [2.491, -0.731], [2.563, -0.438], [2.607, -0.187], [2.649, 0.063], [2.692, 0.374], [2.736, 0.709], [2.755, 0.938], [2.77, 1.133], [2.788, 1.511], [2.808, 1.973], [2.808, 2.152], [2.791, 2.638], [2.772, 3.125], [2.767, 3.189], [2.76, 3.276], [2.707, 3.729], [2.667, 4.061], [2.633, 4.258], [2.586, 4.527], [2.534, 4.775], [2.496, 4.954], [2.408, 5.271], [2.277, 5.734], [2.267, 5.766], [2.26, 5.787], [2.225, 5.871], [1.957, 6.522], [1.747, 6.918], [1.604, 7.162], [1.466, 7.345], [1.209, 7.689], [0.798, 8.11], [0.784, 8.124], [0.751, 8.149], [0.334, 8.442], [0.206, 8.504], [-0.132, 8.669], [-0.343, 8.729], [-0.609, 8.805], [-0.859, 8.828], [-1.091, 8.85], [-1.343, 8.827], [-1.575, 8.805], [-1.795, 8.743], [-2.053, 8.669], [-2.216, 8.591], [-2.521, 8.442], [-2.606, 8.384], [-2.94, 8.149], [-2.967, 8.129], [-2.974, 8.124], [-3.287, 7.806], [-3.399, 7.689], [-3.578, 7.453], [-3.793, 7.162], [-3.842, 7.078], [-3.934, 6.918], [-4.07, 6.66], [-4.141, 6.522], [-4.266, 6.216], [-4.435, 5.787], [-4.452, 5.734], [-4.657, 4.954], [-4.738, 4.527], [-4.808, 4.061], [-4.881, 3.276], [-4.89, 3.125], [-4.893, 2.682], [-4.897, 2.152], [-4.891, 1.973], [-4.825, 1.133], [-4.775, 0.709], [-4.662, 0.063], [-4.554, -0.438], [-4.372, -1.061], [-4.247, -1.429], [-3.886, -2.241], [-3.873, -2.265], [-3.854, -2.295], [-3.443, -2.933], [-2.983, -3.472], [-2.974, -3.482], [-2.968, -3.487], [-2.473, -3.884], [-2.253, -4.005], [-1.952, -4.172], [-1.61, -4.281], [-1.418, -4.344], [-1.029, -4.386], [-0.879, -4.402], [-0.504, -4.362], [-0.346, -4.344], [-0.028, -4.24], [0.175, -4.172], [0.403, -4.043], [0.676, -3.884], [0.795, -3.785], [1.15, -3.482], [1.153, -3.48], [1.159, -3.472], [1.456, -3.098], [1.584, -2.933], [1.73, -2.688], [1.974, -2.265], [1.979, -2.256], [1.985, -2.241], [2.174, -1.763], [2.303, -1.429]]
lines3 = [(4.78723, 12.23405), (5.31915, 11.3872), (5.85106, 11.17022), (6.38298, 10.32337), (6.38298, 9.25954), (5.85106, 10.10639), (5.31915, 10.32337), (4.78723, 11.17022), (4.25532, 11.3872), (3.7234, 12.23405), (2.65957, 12.23405), (3.19149, 11.3872), (3.7234, 11.17022), (4.25532, 10.32337), (4.78723, 10.10639), (5.31915, 9.25954), (5.85106, 9.04255), (6.38298, 8.1957), (6.38298, 7.13187), (5.85106, 7.97872), (5.31915, 8.1957), (4.78723, 9.04255), (4.25532, 9.25954), (3.7234, 10.10639), (3.19149, 10.32337), (2.65957, 11.17022), (2.12766, 11.3872), (1.59574, 12.23405), (0.53191, 12.23405), (1.06383, 11.3872), (1.59574, 11.17022), (2.12766, 10.32337), (2.65957, 10.10639), (3.19149, 9.25954), (3.7234, 9.04255), (4.25532, 8.1957), (4.78723, 7.97872), (5.31915, 7.13187), (5.85106, 6.91489), (6.38298, 6.06804), (6.38298, 5.00422), (5.85106, 5.85107), (5.31915, 6.06804), (4.78723, 6.91489), (4.25532, 7.13187), (3.7234, 7.97872), (3.19149, 8.1957), (2.65957, 9.04255), (2.12766, 9.25954), (1.59574, 10.10639), (1.06383, 10.32337), (0.53191, 11.17022), (0.0, 11.3872), (-0.53192, 12.23405), (-1.59575, 12.23405), (-1.06383, 11.3872), (-0.53192, 11.17022), (0.0, 10.32337), (0.53191, 10.10639), (1.06383, 9.25954), (1.59574, 9.04255), (2.12766, 8.1957), (2.65957, 7.97872), (3.19149, 7.13187), (3.7234, 6.91489), (4.25532, 6.06804), (4.78723, 5.85107), (5.31915, 5.00422), (5.85106, 4.78724), (6.38298, 3.94039), (6.38298, 2.87655), (5.85106, 3.7234), (5.31915, 3.94039), (4.78723, 4.78724), (4.25532, 5.00422), (3.7234, 5.85107), (3.19149, 6.06804), (2.65957, 6.91489), (2.12766, 7.13187), (1.59574, 7.97872), (1.06383, 8.1957), (0.53191, 9.04255), (0.0, 9.25954), (-0.53192, 10.10639), (-1.06383, 10.32337), (-1.59575, 11.17022), (-2.12766, 11.3872), (-2.65958, 12.23405), (-3.72341, 12.23405), (-3.19149, 11.3872), (-2.65958, 11.17022), (-2.12766, 10.32337), (-1.59575, 10.10639), (-1.06383, 9.25954), (-0.53192, 9.04255), (0.0, 8.1957), (0.53191, 7.97872), (1.06383, 7.13187), (1.59574, 6.91489), (2.12766, 6.06804), (2.65957, 5.85107), (3.19149, 5.00422), (3.7234, 4.78724), (4.25532, 3.94039), (4.78723, 3.7234), (5.31915, 2.87655), (5.85106, 2.65958), (6.38298, 1.81273), (6.38298, 0.74889), (5.85106, 1.59574), (5.31915, 1.81273), (4.78723, 2.65958), (4.25532, 2.87655), (3.7234, 3.7234), (3.19149, 3.94039), (2.65957, 4.78724), (2.12766, 5.00422), (1.59574, 5.85107), (1.06383, 6.06804), (0.53191, 6.91489), (0.0, 7.13187), (-0.53192, 7.97872), (-1.06383, 8.1957), (-1.59575, 9.04255), (-2.12766, 9.25954), (-2.65958, 10.10639), (-3.19149, 10.32337), (-3.72341, 11.17022), (-4.25532, 11.3872), (-4.78724, 12.23405), (-5.85107, 12.23405), (-5.31915, 11.3872), (-4.78724, 11.17022), (-4.25532, 10.32337), (-3.72341, 10.10639), (-3.19149, 9.25954), (-2.65958, 9.04255), (-2.12766, 8.1957), (-1.59575, 7.97872), (-1.06383, 7.13187), (-0.53192, 6.91489), (0.0, 6.06804), (0.53191, 5.85107), (1.06383, 5.00422), (1.59574, 4.78724), (2.12766, 3.94039), (2.65957, 3.7234), (3.19149, 2.87655), (3.7234, 2.65958), (4.25532, 1.81273), (4.78723, 1.59574), (5.31915, 0.74889), (5.85106, 0.53191), (6.38298, -0.31494), (6.38298, -1.37876), (5.85106, -0.53191), (5.31915, -0.31494), (4.78723, 0.53191), (4.25532, 0.74889), (3.7234, 1.59574), (3.19149, 1.81273), (2.65957, 2.65958), (2.12766, 2.87655), (1.59574, 3.7234), (1.06383, 3.94039), (0.53191, 4.78724), (0.0, 5.00422), (-0.53192, 5.85107), (-1.06383, 6.06804), (-1.59575, 6.91489), (-2.12766, 7.13187), (-2.65958, 7.97872), (-3.19149, 8.1957), (-3.72341, 9.04255), (-4.25532, 9.25954), (-4.78724, 10.10639), (-5.31915, 10.32337), (-5.85107, 11.17022), (-6.38298, 11.3872), (-6.38298, 10.32337), (-5.85107, 10.10639), (-5.31915, 9.25954), (-4.78724, 9.04255), (-4.25532, 8.1957), (-3.72341, 7.97872), (-3.19149, 7.13187), (-2.65958, 6.91489), (-2.12766, 6.06804), (-1.59575, 5.85107), (-1.06383, 5.00422), (-0.53192, 4.78724), (0.0, 3.94039), (0.53191, 3.7234), (1.06383, 2.87655), (1.59574, 2.65958), (2.12766, 1.81273), (2.65957, 1.59574), (3.19149, 0.74889), (3.7234, 0.53191), (4.25532, -0.31494), (4.78723, -0.53191), (5.31915, -1.37876), (5.85106, -1.59575), (6.38298, -2.4426), (6.38298, -3.50643), (5.85106, -2.65958), (5.31915, -2.4426), (4.78723, -1.59575), (4.25532, -1.37876), (3.7234, -0.53191), (3.19149, -0.31494), (2.65957, 0.53191), (2.12766, 0.74889), (1.59574, 1.59574), (1.06383, 1.81273), (0.53191, 2.65958), (0.0, 2.87655), (-0.53192, 3.7234), (-1.06383, 3.94039), (-1.59575, 4.78724), (-2.12766, 5.00422), (-2.65958, 5.85107), (-3.19149, 6.06804), (-3.72341, 6.91489), (-4.25532, 7.13187), (-4.78724, 7.97872), (-5.31915, 8.1957), (-5.85107, 9.04255), (-6.38298, 9.25954), (-6.38298, 8.1957), (-5.85107, 7.97872), (-5.31915, 7.13187), (-4.78724, 6.91489), (-4.25532, 6.06804), (-3.72341, 5.85107), (-3.19149, 5.00422), (-2.65958, 4.78724), (-2.12766, 3.94039), (-1.59575, 3.7234), (-1.06383, 2.87655), (-0.53192, 2.65958), (0.0, 1.81273), (0.53191, 1.59574), (1.06383, 0.74889), (1.59574, 0.53191), (2.12766, -0.31494), (2.65957, -0.53191), (3.19149, -1.37876), (3.7234, -1.59575), (4.25532, -2.4426), (4.78723, -2.65958), (5.31915, -3.50643), (5.85106, -3.7234), (6.38298, -4.57026), (6.38298, -5.63408), (5.85106, -4.78723), (5.31915, -4.57026), (4.78723, -3.7234), (4.25532, -3.50643), (3.7234, -2.65958), (3.19149, -2.4426), (2.65957, -1.59575), (2.12766, -1.37876), (1.59574, -0.53191), (1.06383, -0.31494), (0.53191, 0.53191), (0.0, 0.74889), (-0.53192, 1.59574), (-1.06383, 1.81273), (-1.59575, 2.65958), (-2.12766, 2.87655), (-2.65958, 3.7234), (-3.19149, 3.94039), (-3.72341, 4.78724), (-4.25532, 5.00422), (-4.78724, 5.85107), (-5.31915, 6.06804), (-5.85107, 6.91489), (-6.38298, 7.13187), (-6.38298, 6.06804), (-5.85107, 5.85107), (-5.31915, 5.00422), (-4.78724, 4.78724), (-4.25532, 3.94039), (-3.72341, 3.7234), (-3.19149, 2.87655), (-2.65958, 2.65958), (-2.12766, 1.81273), (-1.59575, 1.59574), (-1.06383, 0.74889), (-0.53192, 0.53191), (0.0, -0.31494), (0.53191, -0.53191), (1.06383, -1.37876), (1.59574, -1.59575), (2.12766, -2.4426), (2.65957, -2.65958), (3.19149, -3.50643), (3.7234, -3.7234), (4.25532, -4.57026), (4.78723, -4.78723), (5.31915, -5.63408), (5.85106, -5.85107), (6.38298, -6.69792), (6.38298, -7.76175), (5.85106, -6.9149), (5.31915, -6.69792), (4.78723, -5.85107), (4.25532, -5.63408), (3.7234, -4.78723), (3.19149, -4.57026), (2.65957, -3.7234), (2.12766, -3.50643), (1.59574, -2.65958), (1.06383, -2.4426), (0.53191, -1.59575), (0.0, -1.37876), (-0.53192, -0.53191), (-1.06383, -0.31494), (-1.59575, 0.53191), (-2.12766, 0.74889), (-2.65958, 1.59574), (-3.19149, 1.81273), (-3.72341, 2.65958), (-4.25532, 2.87655), (-4.78724, 3.7234), (-5.31915, 3.94039), (-5.85107, 4.78724), (-6.38298, 5.00422), (-6.38298, 3.94039), (-5.85107, 3.7234), (-5.31915, 2.87655), (-4.78724, 2.65958), (-4.25532, 1.81273), (-3.72341, 1.59574), (-3.19149, 0.74889), (-2.65958, 0.53191), (-2.12766, -0.31494), (-1.59575, -0.53191), (-1.06383, -1.37876), (-0.53192, -1.59575), (0.0, -2.4426), (0.53191, -2.65958), (1.06383, -3.50643), (1.59574, -3.7234), (2.12766, -4.57026), (2.65957, -4.78723), (3.19149, -5.63408), (3.7234, -5.85107), (4.25532, -6.69792), (4.78723, -6.9149), (5.31915, -7.76175), (5.85106, -7.97872), (6.38298, -8.82558), (6.38298, -9.88941), (5.85106, -9.04256), (5.31915, -8.82558), (4.78723, -7.97872), (4.25532, -7.76175), (3.7234, -6.9149), (3.19149, -6.69792), (2.65957, -5.85107), (2.12766, -5.63408), (1.59574, -4.78723), (1.06383, -4.57026), (0.53191, -3.7234), (0.0, -3.50643), (-0.53192, -2.65958), (-1.06383, -2.4426), (-1.59575, -1.59575), (-2.12766, -1.37876), (-2.65958, -0.53191), (-3.19149, -0.31494), (-3.72341, 0.53191), (-4.25532, 0.74889), (-4.78724, 1.59574), (-5.31915, 1.81273), (-5.85107, 2.65958), (-6.38298, 2.87655), (-6.38298, 1.81273), (-5.85107, 1.59574), (-5.31915, 0.74889), (-4.78724, 0.53191), (-4.25532, -0.31494), (-3.72341, -0.53191), (-3.19149, -1.37876), (-2.65958, -1.59575), (-2.12766, -2.4426), (-1.59575, -2.65958), (-1.06383, -3.50643), (-0.53192, -3.7234), (0.0, -4.57026), (0.53191, -4.78723), (1.06383, -5.63408), (1.59574, -5.85107), (2.12766, -6.69792), (2.65957, -6.9149), (3.19149, -7.76175), (3.7234, -7.97872), (4.25532, -8.82558), (4.78723, -9.04256), (5.31915, -9.88941), (5.85106, -10.10638), (6.38298, -10.95323), (6.38298, -12.01707), (5.85106, -11.17022), (5.31915, -10.95323), (4.78723, -10.10638), (4.25532, -9.88941), (3.7234, -9.04256), (3.19149, -8.82558), (2.65957, -7.97872), (2.12766, -7.76175), (1.59574, -6.9149), (1.06383, -6.69792), (0.53191, -5.85107), (0.0, -5.63408), (-0.53192, -4.78723), (-1.06383, -4.57026), (-1.59575, -3.7234), (-2.12766, -3.50643), (-2.65958, -2.65958), (-3.19149, -2.4426), (-3.72341, -1.59575), (-4.25532, -1.37876), (-4.78724, -0.53191), (-5.31915, -0.31494), (-5.85107, 0.53191), (-6.38298, 0.74889), (-6.38298, -0.31494), (-5.85107, -0.53191), (-5.31915, -1.37876), (-4.78724, -1.59575), (-4.25532, -2.4426), (-3.72341, -2.65958), (-3.19149, -3.50643), (-2.65958, -3.7234), (-2.12766, -4.57026), (-1.59575, -4.78723), (-1.06383, -5.63408), (-0.53192, -5.85107), (0.0, -6.69792), (0.53191, -6.9149), (1.06383, -7.76175), (1.59574, -7.97872), (2.12766, -8.82558), (2.65957, -9.04256), (3.19149, -9.88941), (3.7234, -10.10638), (4.25532, -10.95323), (4.78723, -11.17022), (5.31915, -12.01707), (5.85106, -12.23405), (4.78723, -12.23405), (4.25532, -12.01707), (3.7234, -11.17022), (3.19149, -10.95323), (2.65957, -10.10638), (2.12766, -9.88941), (1.59574, -9.04256), (1.06383, -8.82558), (0.53191, -7.97872), (0.0, -7.76175), (-0.53192, -6.9149), (-1.06383, -6.69792), (-1.59575, -5.85107), (-2.12766, -5.63408), (-2.65958, -4.78723), (-3.19149, -4.57026), (-3.72341, -3.7234), (-4.25532, -3.50643), (-4.78724, -2.65958), (-5.31915, -2.4426), (-5.85107, -1.59575), (-6.38298, -1.37876), (-6.38298, -2.4426), (-5.85107, -2.65958), (-5.31915, -3.50643), (-4.78724, -3.7234), (-4.25532, -4.57026), (-3.72341, -4.78723), (-3.19149, -5.63408), (-2.65958, -5.85107), (-2.12766, -6.69792), (-1.59575, -6.9149), (-1.06383, -7.76175), (-0.53192, -7.97872), (0.0, -8.82558), (0.53191, -9.04256), (1.06383, -9.88941), (1.59574, -10.10638), (2.12766, -10.95323), (2.65957, -11.17022), (3.19149, -12.01707), (3.7234, -12.23405), (2.65957, -12.23405), (2.12766, -12.01707), (1.59574, -11.17022), (1.06383, -10.95323), (0.53191, -10.10638), (0.0, -9.88941), (-0.53192, -9.04256), (-1.06383, -8.82558), (-1.59575, -7.97872), (-2.12766, -7.76175), (-2.65958, -6.9149), (-3.19149, -6.69792), (-3.72341, -5.85107), (-4.25532, -5.63408), (-4.78724, -4.78723), (-5.31915, -4.57026), (-5.85107, -3.7234), (-6.38298, -3.50643), (-6.38298, -4.57026), (-5.85107, -4.78723), (-5.31915, -5.63408), (-4.78724, -5.85107), (-4.25532, -6.69792), (-3.72341, -6.9149), (-3.19149, -7.76175), (-2.65958, -7.97872), (-2.12766, -8.82558), (-1.59575, -9.04256), (-1.06383, -9.88941), (-0.53192, -10.10638), (0.0, -10.95323), (0.53191, -11.17022), (1.06383, -12.01707), (1.59574, -12.23405), (0.53191, -12.23405), (0.0, -12.01707), (-0.53192, -11.17022), (-1.06383, -10.95323), (-1.59575, -10.10638), (-2.12766, -9.88941), (-2.65958, -9.04256), (-3.19149, -8.82558), (-3.72341, -7.97872), (-4.25532, -7.76175), (-4.78724, -6.9149), (-5.31915, -6.69792), (-5.85107, -5.85107), (-6.38298, -5.63408), (-6.38298, -6.69792), (-5.85107, -6.9149), (-5.31915, -7.76175), (-4.78724, -7.97872), (-4.25532, -8.82558), (-3.72341, -9.04256), (-3.19149, -9.88941), (-2.65958, -10.10638), (-2.12766, -10.95323), (-1.59575, -11.17022), (-1.06383, -12.01707), (-0.53192, -12.23405), (-1.59575, -12.23405), (-2.12766, -12.01707), (-2.65958, -11.17022), (-3.19149, -10.95323), (-3.72341, -10.10638), (-4.25532, -9.88941), (-4.78724, -9.04256), (-5.31915, -8.82558), (-5.85107, -7.97872), (-6.38298, -7.76175), (-6.38298, -8.82558), (-5.85107, -9.04256), (-5.31915, -9.88941), (-4.78724, -10.10638), (-4.25532, -10.95323), (-3.72341, -11.17022), (-3.19149, -12.01707), (-2.65958, -12.23405), (-3.72341, -12.23405), (-4.25532, -12.01707), (-4.78724, -11.17022), (-5.31915, -10.95323), (-5.85107, -10.10638), (-6.38298, -9.88941), (-6.38298, -10.95323), (-5.85107, -11.17022), (-5.31915, -12.01707), (-4.78724, -12.23405)]

mask4 = [[2.8, 4.285], [2.782, 4.404], [2.697, 4.812], [2.592, 5.303], [2.583, 5.335], [2.57, 5.382], [2.429, 5.824], [2.334, 6.12], [2.134, 6.603], [2.021, 6.848], [1.877, 7.092], [1.658, 7.467], [1.378, 7.84], [1.257, 7.987], [1.186, 8.053], [0.825, 8.393], [0.574, 8.568], [0.373, 8.709], [0.002, 8.889], [-0.094, 8.936], [-0.532, 9.059], [-0.572, 9.071], [-1.034, 9.114], [-1.057, 9.116], [-1.506, 9.074], [-1.541, 9.071], [-1.948, 8.957], [-2.022, 8.936], [-2.359, 8.774], [-2.492, 8.709], [-2.741, 8.538], [-2.947, 8.393], [-3.092, 8.259], [-3.381, 7.987], [-3.416, 7.945], [-3.502, 7.84], [-3.701, 7.576], [-3.781, 7.467], [-3.954, 7.175], [-4.142, 6.848], [-4.184, 6.758], [-4.253, 6.603], [-4.377, 6.301], [-4.448, 6.12], [-4.674, 5.382], [-4.694, 5.303], [-4.733, 5.098], [-4.867, 4.404], [-4.904, 4.124], [-4.968, 3.45], [-4.997, 2.823], [-5.0, 2.457], [-4.968, 1.506], [-4.961, 1.417], [-4.893, 0.842], [-4.833, 0.331], [-4.822, 0.258], [-4.593, -0.806], [-4.579, -0.858], [-4.506, -1.073], [-4.256, -1.813], [-4.176, -1.992], [-3.868, -2.611], [-3.465, -3.229], [-3.432, -3.277], [-3.402, -3.309], [-2.954, -3.795], [-2.627, -4.053], [-2.448, -4.197], [-1.934, -4.478], [-1.921, -4.485], [-1.843, -4.51], [-1.382, -4.649], [-1.321, -4.655], [-0.839, -4.704], [-0.761, -4.696], [-0.3, -4.649], [-0.25, -4.633], [0.149, -4.51], [0.217, -4.488], [0.226, -4.485], [0.633, -4.254], [0.732, -4.197], [1.01, -3.965], [1.21, -3.795], [1.353, -3.631], [1.653, -3.277], [1.664, -3.261], [1.684, -3.229], [1.924, -2.827], [2.049, -2.611], [2.157, -2.369], [2.322, -1.992], [2.363, -1.887], [2.392, -1.813], [2.524, -1.361], [2.667, -0.858], [2.673, -0.833], [2.678, -0.806], [2.773, -0.265], [2.862, 0.258], [2.866, 0.296], [2.87, 0.331], [2.915, 0.882], [2.958, 1.417], [2.96, 1.457], [2.962, 1.506], [2.964, 2.041], [2.965, 2.457], [2.96, 2.615], [2.951, 2.823], [2.925, 3.182], [2.905, 3.45], [2.872, 3.738], [2.825, 4.124], [2.8, 4.285]]

lines4 = [(4.78723, -12.23405), (5.31915, -12.01707), (5.85106, -11.17022), (6.38298, -10.95323), (6.38298, -9.88941), (5.85106, -10.10638), (5.31915, -10.95323), (4.78723, -11.17022), (4.25532, -12.01707), (3.7234, -12.23405), (2.65957, -12.23405), (3.19149, -12.01707), (3.7234, -11.17022), (4.25532, -10.95323), (4.78723, -10.10638), (5.31915, -9.88941), (5.85106, -9.04256), (6.38298, -8.82558), (6.38298, -7.76175), (5.85106, -7.97872), (5.31915, -8.82558), (4.78723, -9.04256), (4.25532, -9.88941), (3.7234, -10.10638), (3.19149, -10.95323), (2.65957, -11.17022), (2.12766, -12.01707), (1.59574, -12.23405), (0.53191, -12.23405), (1.06383, -12.01707), (1.59574, -11.17022), (2.12766, -10.95323), (2.65957, -10.10638), (3.19149, -9.88941), (3.7234, -9.04256), (4.25532, -8.82558), (4.78723, -7.97872), (5.31915, -7.76175), (5.85106, -6.9149), (6.38298, -6.69792), (6.38298, -5.63408), (5.85106, -5.85107), (5.31915, -6.69792), (4.78723, -6.9149), (4.25532, -7.76175), (3.7234, -7.97872), (3.19149, -8.82558), (2.65957, -9.04256), (2.12766, -9.88941), (1.59574, -10.10638), (1.06383, -10.95323), (0.53191, -11.17022), (0.0, -12.01707), (-0.53192, -12.23405), (-1.59575, -12.23405), (-1.06383, -12.01707), (-0.53192, -11.17022), (0.0, -10.95323), (0.53191, -10.10638), (1.06383, -9.88941), (1.59574, -9.04256), (2.12766, -8.82558), (2.65957, -7.97872), (3.19149, -7.76175), (3.7234, -6.9149), (4.25532, -6.69792), (4.78723, -5.85107), (5.31915, -5.63408), (5.85106, -4.78723), (6.38298, -4.57026), (6.38298, -3.50643), (5.85106, -3.7234), (5.31915, -4.57026), (4.78723, -4.78723), (4.25532, -5.63408), (3.7234, -5.85107), (3.19149, -6.69792), (2.65957, -6.9149), (2.12766, -7.76175), (1.59574, -7.97872), (1.06383, -8.82558), (0.53191, -9.04256), (0.0, -9.88941), (-0.53192, -10.10638), (-1.06383, -10.95323), (-1.59575, -11.17022), (-2.12766, -12.01707), (-2.65958, -12.23405), (-3.72341, -12.23405), (-3.19149, -12.01707), (-2.65958, -11.17022), (-2.12766, -10.95323), (-1.59575, -10.10638), (-1.06383, -9.88941), (-0.53192, -9.04256), (0.0, -8.82558), (0.53191, -7.97872), (1.06383, -7.76175), (1.59574, -6.9149), (2.12766, -6.69792), (2.65957, -5.85107), (3.19149, -5.63408), (3.7234, -4.78723), (4.25532, -4.57026), (4.78723, -3.7234), (5.31915, -3.50643), (5.85106, -2.65958), (6.38298, -2.4426), (6.38298, -1.37876), (5.85106, -1.59575), (5.31915, -2.4426), (4.78723, -2.65958), (4.25532, -3.50643), (3.7234, -3.7234), (3.19149, -4.57026), (2.65957, -4.78723), (2.12766, -5.63408), (1.59574, -5.85107), (1.06383, -6.69792), (0.53191, -6.9149), (0.0, -7.76175), (-0.53192, -7.97872), (-1.06383, -8.82558), (-1.59575, -9.04256), (-2.12766, -9.88941), (-2.65958, -10.10638), (-3.19149, -10.95323), (-3.72341, -11.17022), (-4.25532, -12.01707), (-4.78724, -12.23405), (-5.85107, -12.23405), (-5.31915, -12.01707), (-4.78724, -11.17022), (-4.25532, -10.95323), (-3.72341, -10.10638), (-3.19149, -9.88941), (-2.65958, -9.04256), (-2.12766, -8.82558), (-1.59575, -7.97872), (-1.06383, -7.76175), (-0.53192, -6.9149), (0.0, -6.69792), (0.53191, -5.85107), (1.06383, -5.63408), (1.59574, -4.78723), (2.12766, -4.57026), (2.65957, -3.7234), (3.19149, -3.50643), (3.7234, -2.65958), (4.25532, -2.4426), (4.78723, -1.59575), (5.31915, -1.37876), (5.85106, -0.53191), (6.38298, -0.31494), (6.38298, 0.74889), (5.85106, 0.53191), (5.31915, -0.31494), (4.78723, -0.53191), (4.25532, -1.37876), (3.7234, -1.59575), (3.19149, -2.4426), (2.65957, -2.65958), (2.12766, -3.50643), (1.59574, -3.7234), (1.06383, -4.57026), (0.53191, -4.78723), (0.0, -5.63408), (-0.53192, -5.85107), (-1.06383, -6.69792), (-1.59575, -6.9149), (-2.12766, -7.76175), (-2.65958, -7.97872), (-3.19149, -8.82558), (-3.72341, -9.04256), (-4.25532, -9.88941), (-4.78724, -10.10638), (-5.31915, -10.95323), (-5.85107, -11.17022), (-6.38298, -12.01707), (-6.38298, -10.95323), (-5.85107, -10.10638), (-5.31915, -9.88941), (-4.78724, -9.04256), (-4.25532, -8.82558), (-3.72341, -7.97872), (-3.19149, -7.76175), (-2.65958, -6.9149), (-2.12766, -6.69792), (-1.59575, -5.85107), (-1.06383, -5.63408), (-0.53192, -4.78723), (0.0, -4.57026), (0.53191, -3.7234), (1.06383, -3.50643), (1.59574, -2.65958), (2.12766, -2.4426), (2.65957, -1.59575), (3.19149, -1.37876), (3.7234, -0.53191), (4.25532, -0.31494), (4.78723, 0.53191), (5.31915, 0.74889), (5.85106, 1.59574), (6.38298, 1.81273), (6.38298, 2.87655), (5.85106, 2.65958), (5.31915, 1.81273), (4.78723, 1.59574), (4.25532, 0.74889), (3.7234, 0.53191), (3.19149, -0.31494), (2.65957, -0.53191), (2.12766, -1.37876), (1.59574, -1.59575), (1.06383, -2.4426), (0.53191, -2.65958), (0.0, -3.50643), (-0.53192, -3.7234), (-1.06383, -4.57026), (-1.59575, -4.78723), (-2.12766, -5.63408), (-2.65958, -5.85107), (-3.19149, -6.69792), (-3.72341, -6.9149), (-4.25532, -7.76175), (-4.78724, -7.97872), (-5.31915, -8.82558), (-5.85107, -9.04256), (-6.38298, -9.88941), (-6.38298, -8.82558), (-5.85107, -7.97872), (-5.31915, -7.76175), (-4.78724, -6.9149), (-4.25532, -6.69792), (-3.72341, -5.85107), (-3.19149, -5.63408), (-2.65958, -4.78723), (-2.12766, -4.57026), (-1.59575, -3.7234), (-1.06383, -3.50643), (-0.53192, -2.65958), (0.0, -2.4426), (0.53191, -1.59575), (1.06383, -1.37876), (1.59574, -0.53191), (2.12766, -0.31494), (2.65957, 0.53191), (3.19149, 0.74889), (3.7234, 1.59574), (4.25532, 1.81273), (4.78723, 2.65958), (5.31915, 2.87655), (5.85106, 3.7234), (6.38298, 3.94039), (6.38298, 5.00422), (5.85106, 4.78724), (5.31915, 3.94039), (4.78723, 3.7234), (4.25532, 2.87655), (3.7234, 2.65958), (3.19149, 1.81273), (2.65957, 1.59574), (2.12766, 0.74889), (1.59574, 0.53191), (1.06383, -0.31494), (0.53191, -0.53191), (0.0, -1.37876), (-0.53192, -1.59575), (-1.06383, -2.4426), (-1.59575, -2.65958), (-2.12766, -3.50643), (-2.65958, -3.7234), (-3.19149, -4.57026), (-3.72341, -4.78723), (-4.25532, -5.63408), (-4.78724, -5.85107), (-5.31915, -6.69792), (-5.85107, -6.9149), (-6.38298, -7.76175), (-6.38298, -6.69792), (-5.85107, -5.85107), (-5.31915, -5.63408), (-4.78724, -4.78723), (-4.25532, -4.57026), (-3.72341, -3.7234), (-3.19149, -3.50643), (-2.65958, -2.65958), (-2.12766, -2.4426), (-1.59575, -1.59575), (-1.06383, -1.37876), (-0.53192, -0.53191), (0.0, -0.31494), (0.53191, 0.53191), (1.06383, 0.74889), (1.59574, 1.59574), (2.12766, 1.81273), (2.65957, 2.65958), (3.19149, 2.87655), (3.7234, 3.7234), (4.25532, 3.94039), (4.78723, 4.78724), (5.31915, 5.00422), (5.85106, 5.85107), (6.38298, 6.06804), (6.38298, 7.13187), (5.85106, 6.91489), (5.31915, 6.06804), (4.78723, 5.85107), (4.25532, 5.00422), (3.7234, 4.78724), (3.19149, 3.94039), (2.65957, 3.7234), (2.12766, 2.87655), (1.59574, 2.65958), (1.06383, 1.81273), (0.53191, 1.59574), (0.0, 0.74889), (-0.53192, 0.53191), (-1.06383, -0.31494), (-1.59575, -0.53191), (-2.12766, -1.37876), (-2.65958, -1.59575), (-3.19149, -2.4426), (-3.72341, -2.65958), (-4.25532, -3.50643), (-4.78724, -3.7234), (-5.31915, -4.57026), (-5.85107, -4.78723), (-6.38298, -5.63408), (-6.38298, -4.57026), (-5.85107, -3.7234), (-5.31915, -3.50643), (-4.78724, -2.65958), (-4.25532, -2.4426), (-3.72341, -1.59575), (-3.19149, -1.37876), (-2.65958, -0.53191), (-2.12766, -0.31494), (-1.59575, 0.53191), (-1.06383, 0.74889), (-0.53192, 1.59574), (0.0, 1.81273), (0.53191, 2.65958), (1.06383, 2.87655), (1.59574, 3.7234), (2.12766, 3.94039), (2.65957, 4.78724), (3.19149, 5.00422), (3.7234, 5.85107), (4.25532, 6.06804), (4.78723, 6.91489), (5.31915, 7.13187), (5.85106, 7.97872), (6.38298, 8.1957), (6.38298, 9.25954), (5.85106, 9.04255), (5.31915, 8.1957), (4.78723, 7.97872), (4.25532, 7.13187), (3.7234, 6.91489), (3.19149, 6.06804), (2.65957, 5.85107), (2.12766, 5.00422), (1.59574, 4.78724), (1.06383, 3.94039), (0.53191, 3.7234), (0.0, 2.87655), (-0.53192, 2.65958), (-1.06383, 1.81273), (-1.59575, 1.59574), (-2.12766, 0.74889), (-2.65958, 0.53191), (-3.19149, -0.31494), (-3.72341, -0.53191), (-4.25532, -1.37876), (-4.78724, -1.59575), (-5.31915, -2.4426), (-5.85107, -2.65958), (-6.38298, -3.50643), (-6.38298, -2.4426), (-5.85107, -1.59575), (-5.31915, -1.37876), (-4.78724, -0.53191), (-4.25532, -0.31494), (-3.72341, 0.53191), (-3.19149, 0.74889), (-2.65958, 1.59574), (-2.12766, 1.81273), (-1.59575, 2.65958), (-1.06383, 2.87655), (-0.53192, 3.7234), (0.0, 3.94039), (0.53191, 4.78724), (1.06383, 5.00422), (1.59574, 5.85107), (2.12766, 6.06804), (2.65957, 6.91489), (3.19149, 7.13187), (3.7234, 7.97872), (4.25532, 8.1957), (4.78723, 9.04255), (5.31915, 9.25954), (5.85106, 10.10639), (6.38298, 10.32337), (6.38298, 11.3872), (5.85106, 11.17022), (5.31915, 10.32337), (4.78723, 10.10639), (4.25532, 9.25954), (3.7234, 9.04255), (3.19149, 8.1957), (2.65957, 7.97872), (2.12766, 7.13187), (1.59574, 6.91489), (1.06383, 6.06804), (0.53191, 5.85107), (0.0, 5.00422), (-0.53192, 4.78724), (-1.06383, 3.94039), (-1.59575, 3.7234), (-2.12766, 2.87655), (-2.65958, 2.65958), (-3.19149, 1.81273), (-3.72341, 1.59574), (-4.25532, 0.74889), (-4.78724, 0.53191), (-5.31915, -0.31494), (-5.85107, -0.53191), (-6.38298, -1.37876), (-6.38298, -0.31494), (-5.85107, 0.53191), (-5.31915, 0.74889), (-4.78724, 1.59574), (-4.25532, 1.81273), (-3.72341, 2.65958), (-3.19149, 2.87655), (-2.65958, 3.7234), (-2.12766, 3.94039), (-1.59575, 4.78724), (-1.06383, 5.00422), (-0.53192, 5.85107), (0.0, 6.06804), (0.53191, 6.91489), (1.06383, 7.13187), (1.59574, 7.97872), (2.12766, 8.1957), (2.65957, 9.04255), (3.19149, 9.25954), (3.7234, 10.10639), (4.25532, 10.32337), (4.78723, 11.17022), (5.31915, 11.3872), (5.85106, 12.23405), (4.78723, 12.23405), (4.25532, 11.3872), (3.7234, 11.17022), (3.19149, 10.32337), (2.65957, 10.10639), (2.12766, 9.25954), (1.59574, 9.04255), (1.06383, 8.1957), (0.53191, 7.97872), (0.0, 7.13187), (-0.53192, 6.91489), (-1.06383, 6.06804), (-1.59575, 5.85107), (-2.12766, 5.00422), (-2.65958, 4.78724), (-3.19149, 3.94039), (-3.72341, 3.7234), (-4.25532, 2.87655), (-4.78724, 2.65958), (-5.31915, 1.81273), (-5.85107, 1.59574), (-6.38298, 0.74889), (-6.38298, 1.81273), (-5.85107, 2.65958), (-5.31915, 2.87655), (-4.78724, 3.7234), (-4.25532, 3.94039), (-3.72341, 4.78724), (-3.19149, 5.00422), (-2.65958, 5.85107), (-2.12766, 6.06804), (-1.59575, 6.91489), (-1.06383, 7.13187), (-0.53192, 7.97872), (0.0, 8.1957), (0.53191, 9.04255), (1.06383, 9.25954), (1.59574, 10.10639), (2.12766, 10.32337), (2.65957, 11.17022), (3.19149, 11.3872), (3.7234, 12.23405), (2.65957, 12.23405), (2.12766, 11.3872), (1.59574, 11.17022), (1.06383, 10.32337), (0.53191, 10.10639), (0.0, 9.25954), (-0.53192, 9.04255), (-1.06383, 8.1957), (-1.59575, 7.97872), (-2.12766, 7.13187), (-2.65958, 6.91489), (-3.19149, 6.06804), (-3.72341, 5.85107), (-4.25532, 5.00422), (-4.78724, 4.78724), (-5.31915, 3.94039), (-5.85107, 3.7234), (-6.38298, 2.87655), (-6.38298, 3.94039), (-5.85107, 4.78724), (-5.31915, 5.00422), (-4.78724, 5.85107), (-4.25532, 6.06804), (-3.72341, 6.91489), (-3.19149, 7.13187), (-2.65958, 7.97872), (-2.12766, 8.1957), (-1.59575, 9.04255), (-1.06383, 9.25954), (-0.53192, 10.10639), (0.0, 10.32337), (0.53191, 11.17022), (1.06383, 11.3872), (1.59574, 12.23405), (0.53191, 12.23405), (0.0, 11.3872), (-0.53192, 11.17022), (-1.06383, 10.32337), (-1.59575, 10.10639), (-2.12766, 9.25954), (-2.65958, 9.04255), (-3.19149, 8.1957), (-3.72341, 7.97872), (-4.25532, 7.13187), (-4.78724, 6.91489), (-5.31915, 6.06804), (-5.85107, 5.85107), (-6.38298, 5.00422), (-6.38298, 6.06804), (-5.85107, 6.91489), (-5.31915, 7.13187), (-4.78724, 7.97872), (-4.25532, 8.1957), (-3.72341, 9.04255), (-3.19149, 9.25954), (-2.65958, 10.10639), (-2.12766, 10.32337), (-1.59575, 11.17022), (-1.06383, 11.3872), (-0.53192, 12.23405), (-1.59575, 12.23405), (-2.12766, 11.3872), (-2.65958, 11.17022), (-3.19149, 10.32337), (-3.72341, 10.10639), (-4.25532, 9.25954), (-4.78724, 9.04255), (-5.31915, 8.1957), (-5.85107, 7.97872), (-6.38298, 7.13187), (-6.38298, 8.1957), (-5.85107, 9.04255), (-5.31915, 9.25954), (-4.78724, 10.10639), (-4.25532, 10.32337), (-3.72341, 11.17022), (-3.19149, 11.3872), (-2.65958, 12.23405), (-3.72341, 12.23405), (-4.25532, 11.3872), (-4.78724, 11.17022), (-5.31915, 10.32337), (-5.85107, 10.10639), (-6.38298, 9.25954), (-6.38298, 10.32337), (-5.85107, 11.17022), (-5.31915, 11.3872), (-4.78724, 12.23405)]

# Find intersections
intersections = clip_paths(mask, lines)
intersections2 = clip_paths(mask2, lines2)
intersections3 = clip_paths(mask3, lines3)
intersections4 = clip_paths(mask4, lines4)



# Plotting
fig = plt.figure(figsize=(12, 8))
ax = fig.add_subplot(111, projection='3d')

# Updating arrays with appropriate z-values
z1 = 3
z2 = 6 
z3 = 9
mask = add_z_coordinate(mask, 0)
lines = add_z_coordinate(lines, 0)
intersections = add_z_coordinate(intersections, 0)

mask2 = add_z_coordinate(mask2, z1)
lines2 = add_z_coordinate(lines2, z1)
intersections2 = add_z_coordinate(intersections2, z1)

mask3 = add_z_coordinate(mask3, z2)
lines3 = add_z_coordinate(lines3, z2)
intersections3 = add_z_coordinate(intersections3, z2)

mask4 = add_z_coordinate(mask4, z3)
lines4 = add_z_coordinate(lines4, z3)
intersections4 = add_z_coordinate(intersections4, z3)

plot_segments(ax, intersections, 'blue')
plot_segments(ax, intersections3, 'blue')

plot_segments(ax, intersections2, 'red')
plot_segments(ax, intersections4, 'red')


plt.title("Generate Printing Path")
ax.set_xlim([-6, 5])
ax.set_ylim([-5, 10])
ax.set_zlim([0, z3+3])

ax.set_xlabel('X axis')
ax.set_ylabel('Y axis')
ax.set_zlabel('Z axis')

# plt.grid()
plt.gca().set_aspect('equal', adjustable='box')
# plt.legend()
plt.show()